# 学生管理系统Web应用开发与性能测试实验报告

---

## 目录

[第1章 引言](#第1章-引言)
- [1.1 实验背景](#11-实验背景)
- [1.2 实验目的](#12-实验目的)
- [1.3 实验内容](#13-实验内容)

[第2章 实验环境与工具](#第2章-实验环境与工具)
- [2.1 开发环境](#21-开发环境)
- [2.2 测试工具](#22-测试工具)
- [2.3 技术栈](#23-技术栈)

[第3章 系统设计与实现](#第3章-系统设计与实现)
- [3.1 系统架构](#31-系统架构)
- [3.2 数据库设计](#32-数据库设计)
- [3.3 CRUD功能实现](#33-crud功能实现)

[第4章 性能测试设计](#第4章-性能测试设计)
- [4.1 测试场景设计](#41-测试场景设计)
- [4.2 测试参数配置](#42-测试参数配置)
- [4.3 测试数据准备](#43-测试数据准备)

[第5章 测试结果与分析](#第5章-测试结果与分析)
- [5.1 测试执行概况](#51-测试执行概况)
- [5.2 详细测试结果](#52-详细测试结果)
- [5.3 性能指标分析](#53-性能指标分析)
- [5.4 性能瓶颈分析](#54-性能瓶颈分析)

[第6章 总结](#第6章-总结)
- [6.1 实验结论](#61-实验结论)
- [6.2 实验体会](#62-实验体会)
- [6.3 存在的问题](#63-存在的问题)
- [6.4 未来工作展望](#64-未来工作展望)

[参考文献](#参考文献)

---

## 第1章 引言

### 1.1 实验背景

随着Web应用的广泛使用，系统性能已成为衡量软件质量的重要指标之一。在实际开发中，不仅要保证功能的正确性，还需要确保系统在高并发场景下的稳定性和响应速度。本实验基于ASP.NET Core框架开发了一个学生管理系统，并使用Apache JMeter进行性能测试，以评估系统在不同负载下的表现。

### 1.2 实验目的

1. 掌握ASP.NET Core Web应用的开发流程
2. 实现完整的CRUD（创建、读取、更新、删除）功能
3. 学习使用Entity Framework Core进行数据持久化
4. 掌握Apache JMeter性能测试工具的使用方法
5. 分析Web应用的性能指标，识别性能瓶颈
6. 理解并发访问对系统性能的影响

### 1.3 实验内容

本实验主要包含两个部分：

**实验内容之一：Web应用开发**
- 使用ASP.NET Core Razor Pages开发学生管理系统
- 实现对学生信息的完整CRUD操作
- 使用Entity Framework Core进行数据库操作
- 实现数据验证和错误处理

**实验内容之二：JMeter性能测试**
- 设计针对CRUD操作的性能测试场景
- 配置多线程并发测试
- 收集和分析性能指标数据
- 生成测试报告

**示例页面：** `/StudentPage`（CRUD操作界面）

---

## 第2章 实验环境与工具

### 2.1 开发环境

- **操作系统：** Windows
- **开发框架：** .NET 8.0
- **开发工具：** Visual Studio Code / Visual Studio 2022
- **数据库：** SQL Server Express (localhost\SQLEXPRESS)
- **Web服务器：** Kestrel (http://localhost:5110)

### 2.2 测试工具

- **性能测试工具：** Apache JMeter
- **测试脚本：** StudentApp_Performance_Test.jmx
- **测试数据：** student_ids.csv
- **并发线程数：** 100线程/操作
- **总样本数：** 500个请求

### 2.3 技术栈

- **后端框架：** ASP.NET Core 8.0
- **页面技术：** Razor Pages
- **ORM框架：** Entity Framework Core
- **数据库提供程序：** Microsoft.EntityFrameworkCore.SqlServer
- **前端框架：** Bootstrap 5
- **数据验证：** Data Annotations
- **数据库迁移：** EF Core Migrations

---

## 第3章 系统设计与实现

### 3.1 系统架构

学生管理系统采用经典的三层架构：

```
┌─────────────────────────────────┐
│     表示层 (Razor Pages)         │
│  - Index.cshtml                 │
│  - Create.cshtml                │
│  - Edit.cshtml                  │
│  - Details.cshtml               │
│  - Delete.cshtml                │
└─────────────────────────────────┘
            ↓
┌─────────────────────────────────┐
│     业务逻辑层 (PageModel)       │
│  - Index.cshtml.cs              │
│  - Create.cshtml.cs             │
│  - Edit.cshtml.cs               │
│  - Details.cshtml.cs            │
│  - Delete.cshtml.cs             │
└─────────────────────────────────┘
            ↓
┌─────────────────────────────────┐
│   数据访问层 (EF Core)           │
│  - ApplicationDbContext         │
│  - Student Model                │
└─────────────────────────────────┘
            ↓
┌─────────────────────────────────┐
│   数据库 (SQL Server)            │
└─────────────────────────────────┘
```

### 3.2 数据库设计

**Student表结构：**

| 字段名 | 数据类型 | 说明 | 约束 |
|--------|----------|------|------|
| Id | int | 学生ID | 主键，自增 |
| Name | string | 姓名 | 必填 |
| Age | int | 年龄 | 必填 |
| Email | string | 电子邮件 | 必填，唯一 |
| RegistrationDate | DateTime | 注册日期 | 默认当前日期 |

### 3.3 CRUD功能实现

系统实现了完整的CRUD操作：

1. **查询（Read）** - 显示学生列表
   - 路由：`/StudentPage`
   - 功能：分页显示所有学生信息

2. **创建（Create）** - 添加新学生
   - 路由：`/StudentPage/Create`
   - 功能：表单验证，防止重复邮箱

3. **详情（Read）** - 查看学生详情
   - 路由：`/StudentPage/Details/{id}`
   - 功能：展示单个学生的完整信息

4. **编辑（Update）** - 修改学生信息
   - 路由：`/StudentPage/Edit/{id}`
   - 功能：更新学生数据，保持数据一致性

5. **删除（Delete）** - 删除学生记录
   - 路由：`/StudentPage/Delete/{id}`
   - 功能：确认后删除，防止误操作

---

## 第4章 性能测试设计

### 4.1 被测系统重点

本次性能测试的关键测试对象和重点如下：

**✓ 页面：** StudentPage (Index) & Create
- 索引页面：`/StudentPage` - 展示学生列表
- 创建页面：`/StudentPage/Create` - 添加新学生表单

**✓ 功能：** 展示 Students 列表 & 添加新学生
- **Index页面功能：** 从数据库查询所有学生记录，在页面上以表格形式展示，包含姓名、年龄、电子邮件、注册日期等信息
- **Create页面功能：** 提供表单接收用户输入，验证数据有效性，将新学生信息保存到数据库

**✓ 技术：** Razor Pages + EF Core + SQL Server
- **前端技术：** ASP.NET Core Razor Pages 模板引擎
- **ORM框架：** Entity Framework Core 8.0
- **数据库：** SQL Server Express (localhost\SQLEXPRESS)

**✓ 测试重点：** 高并发访问 Index 与 Create 页的响应情况
- **并发场景：** 100个并发用户同时访问
- **测试目标：** 
  - Index页面在高并发查询下的响应时间和吞吐量
  - Create页面在大量并发写入时的性能表现和数据一致性
  - 系统整体在读写混合负载下的稳定性
- **关注指标：** 平均响应时间、最大/最小响应时间、错误率、吞吐量

### 4.2 测试场景设计

本次测试模拟100个并发用户同时访问系统，执行CRUD操作的场景。测试组包含5个主要操作：

| 测试操作 | 描述 | 请求类型 | 样本数 | 测试重点 |
|----------|------|----------|--------|----------|
| 查询学生列表 | 获取学生索引页面（Index） | GET | 100 | **✓ 高并发读取性能** |
| 创建新学生 | 提交新学生表单（Create） | POST | 100 | **✓ 高并发写入性能** |
| 查看学生详情 | 查看特定学生信息 | GET | 100 |
| 编辑学生信息 | 更新学生数据 | POST | 100 |
| 删除学生 | 删除学生记录 | POST | 100 |

### 4.2 测试参数配置

**线程组配置：**
- 线程数（并发用户数）：100
- 循环次数：1
- Ramp-Up时间：根据需要调整
- 总请求数：500

**HTTP请求配置：**
- 服务器：localhost
- 端口：5110
- 协议：HTTP
- 路径：/StudentPage/*

### 4.3 测试数据准备

使用`SeedTestData.sql`脚本预先填充测试数据，`student_ids.csv`文件提供用于查询、编辑和删除操作的学生ID列表，确保测试过程中有足够的数据支持。

---

## 第5章 测试结果与分析

### 5.1 测试执行概况

测试于2025年12月17日执行完成，总运行时间约56秒。本次测试完整模拟了用户对学生数据的增删改查流程。

**测试步骤视图：**
![JMeter结果树截图](这里插入图片_c5651dd34b3a27b73c78e0c3459a47ca.png)

**总体统计：**
- 总样本数：500
- **错误率：0.20%** (仅1个请求失败)
- **吞吐量：9.0次/秒**
- **平均响应时间：553ms**

### 5.2 详细测试结果

#### 5.2.1 汇总报告数据

以下数据源自 JMeter 聚合报告：

![JMeter聚合报告截图](这里插入图片_fcf5e0e4d81e342d41249775fe57de10.png)

| 操作 | 样本数 | 平均响应时间(ms) | 90%线(ms) | 最小值(ms) | 最大值(ms) | 错误率 | 吞吐量(/s) |
|------|--------|------------------|-----------|-----------|-----------|---------|------------|
| 查询学生列表 | 100 | **905** | 1959 | 392 | 2800 | 0.00% | 1.9 |
| 创建新学生 | 100 | **900** | 2050 | 423 | 2719 | 0.00% | 1.9 |
| 查看学生详情 | 100 | **7** | 14 | 2 | 62 | **1.00%** | 1.9 |
| 编辑学生信息 | 100 | **5** | 12 | 1 | 90 | 0.00% | 1.9 |
| 删除学生 | 100 | **947** | 1986 | 466 | 2682 | 0.00% | 1.9 |
| **总计** | **500** | **553** | **895** | **1** | **2800** | **0.20%** | **9.0** |

### 5.3 性能指标深度分析

#### 5.3.1 读写性能差异分析
从测试结果中观察到一个显著的性能差异现象：
1.  **轻量级操作（编辑、详情）：** 响应时间极快（平均 5-7ms）。这表明 EF Core 在通过主键（ID）进行点查询和更新非索引字段时，效率极高，且数据库缓存命中率良好。
2.  **重量级操作（创建、删除、列表查询）：** 响应时间较长（900ms+）。
    * **原因分析：** `Create` 和 `Delete` 操作涉及到数据库 B+ 树索引的结构调整（页分裂与合并），在高并发下引发了较为严重的**锁竞争（Lock Contention）**。
    * `Query List` 较慢可能是因为未对查询字段添加非聚集索引，导致了全表扫描或索引扫描。

#### 5.3.2 稳定性与错误率
* **错误率分析：** 整体错误率为 0.20%（1/500）。唯一的错误出现在"查看学生详情"中。
* **推测原因：** 这是一个典型的**并发竞争条件（Race Condition）**。在多线程环境下，某个线程试图读取 ID 为 X 的学生详情时，另一个线程恰好执行了"删除 ID 为 X"的操作，导致查询因为找不到记录而抛出异常或返回 404。

#### 5.3.3 吞吐量瓶颈
系统整体吞吐量为 9.0 TPS。对于本地环境而言，该数值受限于：
1.  **数据库配置：** SQL Server Express 版本的资源限制。
2.  **Web服务器连接数：** Kestrel 的默认并发连接限制。
3.  **测试模式：** 本次实验为了直观展示使用了 GUI 模式运行 JMeter，这消耗了大量客户端资源，实际生产测试应采用 CLI 命令行模式。

---

## 第6章 总结

### 6.1 实验结论
本次实验成功构建了基于 ASP.NET Core 的学生管理系统，并验证了其在高并发场景下的表现：
1.  **功能完备性：** 系统 100% 完成了预期的 CRUD 业务逻辑。
2.  **性能特征：** 系统呈现出"读极快、写较慢"的典型数据库应用特征。
3.  **并发能力：** 在 100 并发用户下，系统未发生崩溃，仅有极低概率的数据一致性错误，证明了系统架构的基本稳定性。

### 6.3 改进建议（针对实验中发现的问题）
1.  **数据库优化：** 针对 `Index` 页面涉及的查询字段添加索引；考虑将读写操作分离。
2.  **并发控制：** 引入乐观锁（Optimistic Locking）机制，在编辑和删除时检查 `RowVersion`，解决数据竞争导致的错误。
3.  **测试优化：** 后续应使用命令行模式（Non-GUI mode）运行 JMeter 以获得更准确的吞吐量数据。

---

## 参考文献

[1] Andrew Lock, ASP.NET Core in Action, Manning Publications, 2021

[2] Jon P Smith, Entity Framework Core in Action, Manning Publications, 2021
